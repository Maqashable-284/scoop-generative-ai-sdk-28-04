# ­Ъцќ Scoop GenAI - рЃАрЃърЃЮрЃарЃбрЃБрЃџрЃў рЃЎрЃЋрЃћрЃЉрЃўрЃА AI рЃЎрЃЮрЃюрЃАрЃБрЃџрЃбрЃљрЃюрЃбрЃў

[![Security Grade](https://img.shields.io/badge/Security-B+-green)](CODE_REVIEW_REPORT.md)
[![Python](https://img.shields.io/badge/Python-3.11+-blue)](https://python.org)
[![License](https://img.shields.io/badge/License-MIT-yellow)](LICENSE)

## рЃарЃљ рЃљрЃарЃўрЃА рЃћрЃА рЃърЃарЃЮрЃћрЃЦрЃбрЃў?

рЃћрЃА рЃљрЃарЃўрЃА **рЃГрЃЎрЃЋрЃўрЃљрЃюрЃў рЃЕрЃљрЃбрЃЉрЃЮрЃбрЃў** рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃћрЃ«рЃЏрЃљрЃарЃћрЃЉрЃљ рЃљрЃЊрЃљрЃЏрЃўрЃљрЃюрЃћрЃЉрЃА рЃАрЃърЃЮрЃарЃбрЃБрЃџрЃў рЃЎрЃЋрЃћрЃЉрЃўрЃА рЃърЃарЃЮрЃЊрЃБрЃЦрЃбрЃћрЃЉрЃўрЃА рЃерЃћрЃарЃЕрЃћрЃЋрЃљрЃерЃў. 

рЃгрЃљрЃарЃЏрЃЮрЃўрЃЊрЃњрЃўрЃюрЃћ рЃарЃЮрЃЏ рЃЏрЃљрЃдрЃљрЃќрЃўрЃљрЃерЃў рЃЏрЃўрЃ«рЃЋрЃљрЃџ рЃЊрЃљ рЃњрЃДрЃљрЃЋрЃА **рЃърЃўрЃарЃљрЃЊрЃў рЃЎрЃЮрЃюрЃАрЃБрЃџрЃбрЃљрЃюрЃбрЃў** рЃарЃЮрЃЏрЃћрЃџрЃўрЃф:
- рЃњрЃљрЃ«рЃАрЃЮрЃЋрЃА рЃерЃћрЃюрЃў рЃАрЃљрЃ«рЃћрЃџрЃў рЃЊрЃљ рЃљрЃџрЃћрЃарЃњрЃўрЃћрЃЉрЃў
- рЃўрЃфрЃўрЃА рЃДрЃЋрЃћрЃџрЃљ рЃърЃарЃЮрЃЊрЃБрЃЦрЃбрЃўрЃА рЃцрЃљрЃАрЃў рЃЊрЃљ рЃљрЃдрЃгрЃћрЃарЃљ
- рЃњрЃўрЃарЃЕрЃћрЃЋрЃА рЃарЃљ рЃњрЃГрЃўрЃарЃЊрЃћрЃЉрЃљ рЃерЃћрЃюрЃў рЃЏрЃўрЃќрЃюрЃўрЃА рЃЏрЃўрЃ«рЃћрЃЊрЃЋрЃўрЃЌ

---

## ­ЪДа рЃарЃЮрЃњрЃЮрЃа рЃЏрЃБрЃерЃљрЃЮрЃЉрЃА?

```
рЃЏрЃЮрЃЏрЃ«рЃЏрЃљрЃарЃћрЃЉрЃћрЃџрЃў: "рЃњрЃљрЃЏрЃљрЃарЃ»рЃЮрЃЉрЃљ, рЃЏрЃћ рЃџрЃБрЃЎрЃљ рЃЏрЃЦрЃЋрЃўрЃљ, рЃџрЃљрЃЦрЃбрЃЮрЃќрЃўрЃА рЃљрЃБрЃбрЃљрЃюрЃџрЃЮрЃЉрЃљ рЃЏрЃљрЃЦрЃЋрЃА"
     РєЊ
   [рЃЕрЃљрЃбрЃЉрЃЮрЃбрЃў рЃўрЃюрЃљрЃ«рЃљрЃЋрЃА рЃљрЃЏрЃљрЃА рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃЌрЃљ рЃЉрЃљрЃќрЃљрЃерЃў]
     РєЊ
рЃЏрЃЮрЃЏрЃ«рЃЏрЃљрЃарЃћрЃЉрЃћрЃџрЃў: "рЃЏрЃўрЃарЃЕрЃўрЃћ рЃърЃарЃЮрЃбрЃћрЃўрЃюрЃў"
     РєЊ
   [рЃЕрЃљрЃбрЃЉрЃЮрЃбрЃА рЃљрЃ«рЃАрЃЮрЃЋрЃА рЃарЃЮрЃЏ рЃџрЃљрЃЦрЃбрЃЮрЃќрЃљ рЃљрЃа рЃерЃћрЃўрЃФрЃџрЃћрЃЉрЃљ]
     РєЊ
рЃЕрЃљрЃбрЃЉрЃЮрЃбрЃў: "рЃњрЃўрЃарЃЕрЃћрЃЋ рЃЏрЃфрЃћрЃюрЃљрЃарЃћрЃБрЃџ рЃърЃарЃЮрЃбрЃћрЃўрЃюрЃА - Applied Nutrition Critical Plant..."
```

---

## ­ЪЊЂ рЃърЃарЃЮрЃћрЃЦрЃбрЃўрЃА рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљ

```
scoop-genai-project/
Рћѓ
РћюРћђРћђ main.py                    Рєљ рЃЏрЃЌрЃљрЃЋрЃљрЃарЃў рЃцрЃљрЃўрЃџрЃў (рЃАрЃћрЃарЃЋрЃћрЃарЃў)
РћюРћђРћђ config.py                  Рєљ рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў + System Prompt
РћюРћђРћђ requirements.txt           Рєљ рЃАрЃљрЃГрЃўрЃарЃЮ рЃЉрЃўрЃЉрЃџрЃўрЃЮрЃЌрЃћрЃЎрЃћрЃЉрЃў
РћюРћђРћђ .env                       Рєљ API keys (рЃАрЃљрЃўрЃЊрЃБрЃЏрЃџрЃЮ!)
Рћѓ
РћюРћђРћђ prompts/
Рћѓ   РћћРћђРћђ system_prompt.py       Рєљ AI-рЃўрЃА рЃўрЃюрЃАрЃбрЃарЃБрЃЦрЃфрЃўрЃћрЃЉрЃў
Рћѓ
РћћРћђРћђ app/
    РћюРћђРћђ memory/
    Рћѓ   РћћРћђРћђ mongo_store.py     Рєљ рЃЏрЃљрЃ«рЃАрЃЮрЃЋрЃарЃЮрЃЉрЃљ (MongoDB-рЃерЃў рЃўрЃюрЃљрЃ«рЃљрЃЋрЃА)
    Рћѓ
    РћюРћђРћђ catalog/
    Рћѓ   РћћРћђРћђ loader.py          Рєљ рЃърЃарЃЮрЃЊрЃБрЃЦрЃбрЃћрЃЉрЃўрЃА рЃЕрЃљрЃбрЃЋрЃўрЃарЃЌрЃЋрЃљ
    Рћѓ
    РћћРћђРћђ tools/
        РћћРћђРћђ user_tools.py      Рєљ Gemini Function Calling Tools
```

---

## ­ЪћД рЃбрЃћрЃЦрЃюрЃЮрЃџрЃЮрЃњрЃўрЃћрЃЉрЃў

| рЃбрЃћрЃЦрЃюрЃЮрЃџрЃЮрЃњрЃўрЃљ | рЃЋрЃћрЃарЃАрЃўрЃљ | рЃарЃўрЃАрЃЌрЃЋрЃўрЃА рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃћрЃЉрЃљ |
|------------|--------|---------------------|
| **Google Gemini 2.5 Flash** | Latest | рЃ«рЃћрЃџрЃЮрЃЋрЃюрЃБрЃарЃў рЃўрЃюрЃбрЃћрЃџрЃћрЃЦрЃбрЃў |
| **FastAPI** | 0.115+ | Python рЃЋрЃћрЃЉ-рЃАрЃћрЃарЃЋрЃћрЃарЃў |
| **MongoDB** | 7.0+ | рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃЌрЃљ рЃЉрЃљрЃќрЃљ |
| **Motor** | 3.6+ | Async MongoDB driver |
| **PyMongo** | 4.10+ | Sync MongoDB (Tools) |
| **slowapi** | 0.1.9 | Rate Limiting |

---

## ­Ъџђ Quick Start

### 1. рЃЊрЃљрЃљрЃўрЃюрЃАрЃбрЃљрЃџрЃўрЃарЃћ рЃЉрЃўрЃЉрЃџрЃўрЃЮрЃЌрЃћрЃЎрЃћрЃЉрЃў:
```bash
pip install -r requirements.txt
```

### 2. рЃерЃћрЃЦрЃЏрЃћрЃюрЃў `.env` рЃцрЃљрЃўрЃџрЃў:
```env
# Required
GEMINI_API_KEY=your_gemini_api_key
MONGODB_URI=mongodb+srv://...
MONGODB_DATABASE=scoop_db

# Security (Production)
ADMIN_TOKEN=your_secure_admin_token
ALLOWED_ORIGINS=https://yourdomain.com
DEBUG=false
```

### 3. рЃњрЃљрЃБрЃерЃЋрЃў рЃАрЃћрЃарЃЋрЃћрЃарЃў:
```bash
python3 main.py
```

### 4. рЃерЃћрЃЊрЃћрЃњрЃў:
```
INFO: Uvicorn running on http://0.0.0.0:8080
```

---

## ­ЪЊА API Endpoints

| Endpoint | Method | Description | Auth |
|----------|--------|-------------|------|
| `/` | GET | рЃАрЃћрЃарЃЋрЃћрЃарЃўрЃА рЃАрЃбрЃљрЃбрЃБрЃАрЃў | РЮї |
| `/health` | GET | рЃ»рЃљрЃюрЃЏрЃарЃЌрЃћрЃџрЃЮрЃЉрЃўрЃА рЃерЃћрЃЏрЃЮрЃгрЃЏрЃћрЃЉрЃљ | РЮї |
| `/chat` | POST | рЃЏрЃЌрЃљрЃЋрЃљрЃарЃў рЃЕрЃљрЃбрЃў | РЮї |
| `/chat/stream` | POST | SSE Streaming | РЮї |
| `/sessions` | GET | рЃљрЃЦрЃбрЃўрЃБрЃарЃў рЃАрЃћрЃАрЃўрЃћрЃЉрЃў | РюЁ Admin |
| `/session/clear` | POST | рЃАрЃћрЃАрЃўрЃўрЃА рЃгрЃљрЃерЃџрЃљ | РюЁ Admin |

### рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў - Chat:
```bash
curl -X POST http://localhost:8080/chat \
  -H "Content-Type: application/json" \
  -d '{"user_id": "user123", "message": "рЃЏрЃўрЃюрЃЊрЃљ рЃърЃарЃЮрЃбрЃћрЃўрЃюрЃў"}'
```

### рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў - Admin Endpoint:
```bash
curl -X GET http://localhost:8080/sessions \
  -H "X-Admin-Token: your_admin_token"
```

---

## ­Ъћљ Security Features

### Implemented (v1.1.0)

| Feature | Description |
|---------|-------------|
| **Rate Limiting** | 30 requests/minute per IP (slowapi) |
| **Input Validation** | Pydantic validators (user_id, message length) |
| **Admin Authentication** | X-Admin-Token header required |
| **Regex Injection Protection** | `re.escape()` on user input |
| **Error Message Sanitization** | Error IDs instead of stack traces |
| **CORS Warning** | Logs warning if `*` used in production |

### Environment Variables

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `GEMINI_API_KEY` | РюЁ | - | Google Gemini API Key |
| `MONGODB_URI` | РюЁ | - | MongoDB Connection String |
| `MONGODB_DATABASE` | РЮї | scoop_db | Database Name |
| `ADMIN_TOKEN` | РЮї | - | Admin endpoint auth |
| `ALLOWED_ORIGINS` | РЮї | `*` | CORS origins (comma-separated) |
| `DEBUG` | РЮї | false | Debug mode |

---

## ­ЪДа рЃЏрЃљрЃ«рЃАрЃЮрЃЋрЃарЃЮрЃЉрЃљ (Memory)

рЃЕрЃљрЃбрЃЉрЃЮрЃбрЃА **рЃљрЃ«рЃАрЃЮрЃЋрЃА** рЃДрЃЋрЃћрЃџрЃљрЃцрЃћрЃарЃў:

| рЃарЃљ рЃљрЃ«рЃАрЃЮрЃЋрЃА | рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў |
|-----------|---------| 
| рЃАрЃљрЃ«рЃћрЃџрЃў | "рЃЏрЃћ рЃџрЃБрЃЎрЃљ рЃЏрЃЦрЃЋрЃўрЃљ" |
| рЃљрЃџрЃћрЃарЃњрЃўрЃћрЃЉрЃў | "рЃџрЃљрЃЦрЃбрЃЮрЃќрЃўрЃА рЃљрЃБрЃбрЃљрЃюрЃџрЃЮрЃЉрЃљ рЃЏрЃљрЃЦрЃЋрЃА" |
| рЃЏрЃўрЃќрЃюрЃћрЃЉрЃў | "рЃЎрЃБрЃюрЃЌрЃўрЃА рЃЏрЃљрЃАрЃљ рЃЏрЃўрЃюрЃЊрЃљ" |
| рЃгрЃўрЃюрЃљ рЃЎрЃўрЃЌрЃ«рЃЋрЃћрЃЉрЃў | "рЃарЃљ рЃњрЃЎрЃўрЃЌрЃ«рЃћ?" Рєњ рЃљрЃ«рЃАрЃЮрЃЋрЃА! |

### рЃарЃЮрЃњрЃЮрЃа рЃЏрЃБрЃерЃљрЃЮрЃЉрЃА:
1. рЃДрЃЮрЃЋрЃћрЃџрЃў рЃЏрЃћрЃАрЃўрЃ»рЃў рЃўрЃюрЃљрЃ«рЃћрЃЉрЃљ **MongoDB**-рЃерЃў
2. рЃарЃЮрЃфрЃљ рЃ«рЃћрЃџрЃљрЃ«рЃџрЃљ рЃгрЃћрЃа, рЃЕрЃљрЃбрЃЉрЃЮрЃбрЃў рЃЕрЃљрЃбрЃЋрЃўрЃарЃЌрЃљрЃЋрЃА рЃўрЃАрЃбрЃЮрЃарЃўрЃљрЃА
3. **7 рЃЊрЃдрЃўрЃА** рЃерЃћрЃЏрЃЊрЃћрЃњ рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃљрЃЊ рЃўрЃерЃџрЃћрЃЉрЃљ (TTL Index)

---

## ­ЪЏа№ИЈ Gemini Function Calling

рЃЕрЃљрЃбрЃЉрЃЮрЃбрЃў рЃўрЃДрЃћрЃюрЃћрЃЉрЃА **Automatic Function Calling**-рЃА:

| Tool | Description |
|------|-------------|
| `get_user_profile` | рЃЏрЃЮрЃЏрЃ«рЃЏрЃљрЃарЃћрЃЉрЃџрЃўрЃА рЃърЃарЃЮрЃцрЃўрЃџрЃўрЃА рЃгрЃљрЃЎрЃўрЃЌрЃ«рЃЋрЃљ |
| `update_user_profile` | рЃърЃарЃЮрЃцрЃўрЃџрЃўрЃА рЃњрЃљрЃюрЃљрЃ«рЃџрЃћрЃЉрЃљ |
| `search_products` | рЃърЃарЃЮрЃЊрЃБрЃЦрЃбрЃћрЃЉрЃўрЃА рЃФрЃћрЃЉрЃюрЃљ |
| `get_product_details` | рЃЊрЃћрЃбрЃљрЃџрЃБрЃарЃў рЃўрЃюрЃцрЃЮрЃарЃЏрЃљрЃфрЃўрЃљ |

---

## ­Ъњ░ Cost Comparison

| | Claude SDK (рЃФрЃЋрЃћрЃџрЃў) | Gemini 2.5 Flash |
|--|-------------------|------------------|
| рЃЌрЃЋрЃћрЃерЃў | ~$1,500 | ~$15 |
| рЃЊрЃљрЃюрЃљрЃќрЃЮрЃњрЃў | - | **99%** |

---

## ­ЪЊі Recent Updates

### v1.2.0 (2026-01-13)
- ­ЪЏА№ИЈ **Gemini 3 Fix**: Defensive check for empty `query` in `search_products` (sporadic bug)
- ­Ъћњ **Privacy Controls**: GDPR data deletion endpoint `/user/{user_id}/data`
- ­ЪЊю **History Retrieval**: Multi-session support, sidebar with conversation list
- РюЁ **Consent Modal**: User opt-in for data storage

### v1.1.0 (2026-01-13)
- ­Ъћљ **Security Fixes**: 6 P0 vulnerabilities fixed
- ­ЪћД **Bug Fixes**: Async loop conflict, RepeatedComposite serialization
- РџА **Rate Limiting**: slowapi integration
- РюЁ **Input Validation**: Pydantic validators

### v1.0.0 (2026-01-12)
- ­Ъџђ Initial release
- ­ЪДа Gemini 2.5 Flash integration
- ­ЪњЙ MongoDB persistence
- ­Ъћё Session management

---

## ­ЪЊЮ Documentation

- [CODE_REVIEW_REPORT.md](CODE_REVIEW_REPORT.md) - Security Audit Results
- [docs/RESPONSE_STYLE_GUIDE.md](docs/RESPONSE_STYLE_GUIDE.md) - AI Response Guidelines

---

## ­ЪЉЦ Authors

рЃерЃћрЃЦрЃЏрЃюрЃўрЃџрЃўрЃљ **Scoop.ge**-рЃАрЃЌрЃЋрЃўрЃА

**Repository**: https://github.com/Maqashable-284/scoop-genai-project